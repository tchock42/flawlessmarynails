(()=>{var e={216:()=>{document.addEventListener("DOMContentLoaded",(async function(){let e=[],t=[],o={id:"",nombre:"",idCarrito:""};const r=document.querySelector("#carrito__items"),a=document.querySelector(".carrito__total__cantidad");if(r){await async function(){try{const r="http://localhost:3000/api/usuario",a=new FormData;a.append("usuario","jacob");const n=await fetch(r,{method:"POST",body:a});resultado=await n.json(),console.log(resultado),resultado.usuario&&(console.log("Existe un usuario activo"),o.id=resultado.usuario.id??"",o.idCarrito=resultado.carrito.id??"",o.nombre=resultado.usuario.nombre??""),resultado.productos&&(console.log("Hay productos en carrito"),t=resultado.productos,e=t.map(e=>{const t=document.querySelector(`[data-id = "${e.id_producto}"]`);return{id:e.id_producto,nombre:t.parentElement.querySelector(".producto__resumen").querySelector("H3").textContent.trim(),imagen:t.parentElement.querySelector("IMG").src,precio:t.parentElement.querySelector(".producto__resumen").querySelector("H4").querySelector("SPAN").textContent.trim()}}))}catch(e){console.log("Error al obtener el usuario y carrito:",e)}}(),function(){if(0===e.length){const t=JSON.parse(localStorage.getItem("carritoFMN"));e=t??[]}}();const u=document.querySelectorAll(".producto__agregar"),p=document.getElementById("carrito__pagar");function n(t){const r={id:t.target.dataset.id,nombre:t.target.parentElement.querySelector(".producto__resumen").querySelector("H3").textContent.trim(),imagen:t.target.parentElement.querySelector("IMG").src,precio:t.target.parentElement.querySelector(".producto__resumen").querySelector("H4").querySelector("SPAN").textContent.trim()};if(e.find(e=>e.id===t.target.dataset.id))return void alert("El producto ya se encuentra en el carrito");e=[...e,r];const a=t.target;a.classList.add("selected"),a.innerText="Agregado al carrito",l(),d(),c(),fecha=new Date,fecha=fecha.getUTCFullYear()+"-"+("00"+(fecha.getUTCMonth()+1)).slice(-2)+"-"+("00"+fecha.getUTCDate()).slice(-2)+" "+("00"+fecha.getUTCHours()).slice(-2)+":"+("00"+fecha.getUTCMinutes()).slice(-2)+":"+("00"+fecha.getUTCSeconds()).slice(-2),async function(e){console.log(e);const t=new FormData;if(t.append("fecha",fecha),t.append("estado",0),Object.values(o)[0].length>0)try{const r="http://localhost:3000/api/carrito",a=await fetch(r,{method:"POST",body:t}),n=await a.json();o.idCarrito=n.id;const c=1;console.log("Agregando articulo");const i=new FormData;i.append("id_carrito",o.idCarrito),i.append("id_producto",e.id),i.append("cantidad",c),i.append("precio_unitario",e.precio),i.append("subtotal",+e.precio*c);const s="http://localhost:3000/api/producto",d=await fetch(s,{method:"POST",body:i});await d.json()}catch(e){console.error("Error al guardar el Carrito del usuario",e)}}(r)}function c(){if(function(){for(;r.firstChild;)r.removeChild(r.firstChild),a.textContent="$0.00"}(),e.length>0)e.forEach(t=>{const n=document.createElement("DIV");n.classList.add("carrito__item");const d=document.createElement("IMG");d.classList.add("carrito__item__img"),d.src=t.imagen,productoDetalles=document.createElement("DIV"),productoDetalles.classList.add("carrito__item__detalles");const u=document.createElement("SPAN");u.classList.add("carrito__item__titulo"),u.textContent=t.nombre;const p=document.createElement("SPAN");p.classList.add("carrito__item__precio"),p.textContent=i(t.precio);const m=document.createElement("SPAN");m.classList.add("carrito__item__eliminar"),m.onclick=function(){!async function(t){e=e.filter(e=>e.id!==t);const r=document.querySelector(`[data-id = "${t}"]`);if(r.classList.remove("selected"),r.innerText="Agregar al Carrito",Object.values(o)[0].length>0)try{console.log("Eliminando producto");const e="http://localhost:3000/api/eliminar",o=new FormData;o.append("id_producto",t);const r=await fetch(e,{method:"POST",body:o});await r.json()}catch(e){console.error("Error al eliminar el producto del carrito",e)}c(),s(),l()}(t.id)};const g=document.createElement("I");g.classList.add("fa-solid","fa-trash"),productoDetalles.appendChild(u),productoDetalles.appendChild(p),m.appendChild(g),n.appendChild(d),n.appendChild(productoDetalles),n.appendChild(m),r.appendChild(n),function(){const t=e.reduce((e,t)=>e+parseInt(t.precio),0);a.textContent=i(t)}()});else{const e=document.createElement("P");e.textContent="No hay elementos en tu Carrito",e.classList.add("carrito__item__empty"),r.appendChild(e)}}function i(e){return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(e)}function s(){if(0===e.length){var t=document.getElementById("carrito");t.style.marginRight="-100%",t.style.opacity="0",t.style.height="0",document.getElementById("tienda__listado").style.width="100%"}}function d(){if(e.length>0){console.log("Mostrando carrito");var t=document.getElementById("carrito");t.style.marginRight="0",t.style.opacity="1",t.style.height="auto",document.getElementById("tienda__listado").style.width="100%"}}function l(){localStorage.setItem("carritoFMN",JSON.stringify(e))}u.forEach(e=>e.addEventListener("click",n)),0===e.length?s():(d(),c(),e.forEach(e=>{const t=document.querySelector(`[data-id = "${e.id}"]`);t.classList.add("selected"),t.innerText="Agregado al Carrito"})),p.addEventListener("click",(function(){console.log("Pagando...")}))}}))},527:()=>{document.addEventListener("DOMContentLoaded",(function(){let e={fecha:"",estado:""},t=new Date;t=t.getUTCFullYear()+"-"+("00"+(t.getUTCMonth()+1)).slice(-2)+"-"+("00"+t.getUTCDate()).slice(-2)+" "+("00"+t.getUTCHours()).slice(-2)+":"+("00"+t.getUTCMinutes()).slice(-2)+":"+("00"+t.getUTCSeconds()).slice(-2);const o=document.getElementById("loginForm");o.addEventListener("submit",(async function(r){r.preventDefault();const a=JSON.parse(localStorage.getItem("carritoFMN"))||[];e={fecha:t,estado:0},console.log(e);const n=new FormData(o);n.append("productos",JSON.stringify(a)),n.append("carrito",JSON.stringify(e)),console.log([...n]),respuesta=await fetch("/login",{method:"POST",body:n}),console.log(respuesta),resultado=await respuesta.json(),console.log(resultado)}))}))},265:()=>{document.addEventListener("DOMContentLoaded",(function(){!function(){if(document.querySelector("#mapa")){const e=19.4923279,t=-99.0586138,o=16,r=L.map("mapa").setView([e,t],o);L.tileLayer("https://tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo(r),L.marker([e,t]).addTo(r).bindPopup('\n                <h2 class = "mapa__heading">Flawless Mary Nails</h2>\n                <p class = "mapa__texto">Nail Artist</p>\n            ').openPopup()}}()}))}},t={};function o(r){var a=t[r];if(void 0!==a)return a.exports;var n=t[r]={exports:{}};return e[r](n,n.exports,o),n.exports}o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},o.d=(e,t)=>{for(var r in t)o.o(t,r)&&!o.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";o(265),o(216),o(527)})()})();